(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const p of s.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&r(p)}).observe(document,{childList:!0,subtree:!0});function n(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(t){if(t.ep)return;t.ep=!0;const s=n(t);fetch(t.href,s)}})();const l=document.getElementById("input"),o=document.getElementById("noms"),d=document.getElementById("result"),x=document.getElementById("btn-reset"),v=document.getElementById("btn-hasard"),b=document.getElementById("btn-ajouter"),f=document.getElementById("theme-toggle"),L=document.getElementById("selectGroupe"),y=document.getElementById("checkGroupe"),h=document.getElementById("btn-undo");document.getElementById("btn-export");document.getElementById("btn-print");const c=document.getElementById("btn-afficher"),m=document.getElementById("nombre-participant"),g="hasard_app_participants",u={save(i){try{localStorage.setItem(g,JSON.stringify(i))}catch(e){console.error("Storage save error:",e)}},load(){try{const i=localStorage.getItem(g);return i?JSON.parse(i):[]}catch(i){return console.error("Storage load error:",i),[]}},clear(){try{localStorage.removeItem(g)}catch(i){console.error("Storage clear error:",i)}}};function B(i){return Math.floor(Math.random()*i)}function k(i){const e=B(i.length);return{item:i[e],index:e}}class S{constructor(e){this.participants=[],this.nextId=1,this.deletedStack=[],this.participants=e&&e.length?e:u.load(),this.participants.length&&(this.nextId=Math.max(...this.participants.map(n=>n.id))+1),this.renderParticipantList(),this.updateButtons()}addParticipant(e){const n=e.trim();if(!n)return null;const r={id:this.nextId++,name:n};return this.participants.push(r),u.save(this.participants),this.appendParticipantNode(r),this.updateButtons(),r}deleteParticipant(e){const n=this.participants.findIndex(s=>s.id===e);if(n===-1)return;const[r]=this.participants.splice(n,1);this.deletedStack.push(r),u.save(this.participants),this.renderParticipantList(),this.updateButtons();const t=new CustomEvent("participantDeleted",{detail:r});document.dispatchEvent(t),m.textContent=this.getParticipantsCount(),c.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none"}undoDelete(){const e=this.deletedStack.pop();if(!e)return;this.participants.push(e),this.participants.sort((r,t)=>r.id-t.id),u.save(this.participants),this.renderParticipantList(),this.updateButtons();const n=new CustomEvent("participantUndo",{detail:e});document.dispatchEvent(n)}reset(){this.participants=[],this.deletedStack=[],this.nextId=1,u.clear(),this.clearDom(),this.updateButtons(),c.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none"}generateRandomOrder(){const e=[...this.participants],n=[];for(;e.length;){const{item:r,index:t}=k(e);n.push(r),e.splice(t,1)}return n}generateRandomGroups(e){const n=this.generateRandomOrder(),r=[];for(;n.length;)r.push(n.splice(0,e));return r}clearDom(){o.innerHTML="",d.innerHTML=""}renderParticipantList(){o.innerHTML="",this.participants.forEach(e=>this.appendParticipantNode(e))}appendParticipantNode(e){const n=document.createElement("div");n.className="participant-row";const r=document.createElement("span");r.textContent=`${e.id}. ${e.name}`;const t=document.createElement("button");t.innerHTML='<span class="material-symbols-outlined">delete</span>',t.title="Supprimer ce participant",t.className="delete-btn",t.addEventListener("click",()=>this.deleteParticipant(e.id)),n.appendChild(r),n.appendChild(t),o.appendChild(n)}renderOrder(e){d.innerHTML="",e.forEach((r,t)=>{const s=document.createElement("p");s.textContent=`${t+1}. ${r.name}`,d.appendChild(s)});const n=document.createElement("h3");n.textContent="Fin",n.style.color="var(--troisieme-color)",d.appendChild(n)}renderGroups(e){d.innerHTML="",e.forEach((r,t)=>{const s=document.createElement("h2");s.textContent=`Groupe ${t+1}`,d.appendChild(s),r.forEach((p,I)=>{const E=document.createElement("p");E.textContent=`${I+1}. ${p.name}`,d.appendChild(E)})});const n=document.createElement("h3");n.textContent="Fin",n.style.color="var(--troisieme-color)",d.appendChild(n)}count(){return this.participants.length}updateButtons(){v.disabled=this.participants.length===0}Afficher(e){c.addEventListener("click",()=>{c.classList.toggle("plusMoins")})}getParticipantsCount(){return(this.participants.length?this.participants.length:"").toString()}}const a=new S;function P(){l.style.boxShadow=""}b.addEventListener("click",()=>{if(!a.addParticipant(l.value)){l.style.boxShadow="0 0 20px red",l.focus();return}l.value="",P(),o.scrollTop=o.scrollHeight,c.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none",m.textContent=a.getParticipantsCount()});l.addEventListener("input",()=>{l.classList.add("inputAnimation"),l.style.boxShadow=""});document.addEventListener("keydown",i=>{i.key==="Enter"&&b.click()});x.addEventListener("click",i=>{i.preventDefault(),a.reset(),h.disabled=!0});y.addEventListener("change",()=>{L.style.display=y.checked?"inline-block":"none"});v.addEventListener("click",()=>{if(y.checked){const i=parseInt(L.value,10)||1,e=a.generateRandomGroups(i);a.renderGroups(e)}else{const i=a.generateRandomOrder();a.renderOrder(i)}});h.addEventListener("click",()=>{a.undoDelete(),h.disabled=!0,c.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none",m.textContent=a.getParticipantsCount()});document.addEventListener("participantDeleted",()=>{h.disabled=!1});c.addEventListener("click",()=>{o.classList.toggle("plusMoins"),c.textContent=o.classList.contains("plusMoins")?"Afficher plus":"Afficher moins"});c.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none";m.textContent=a.getParticipantsCount();const M=localStorage.getItem("theme"),T=window.matchMedia("(prefers-color-scheme: dark)").matches,C=M||(T?"dark":"light");document.documentElement.setAttribute("data-theme",C);f.innerHTML=C==="light"?'<i class="fa-solid fa-moon"></i> Mode sombre':'<i class="fa-solid fa-sun"></i> Mode clair';f.addEventListener("click",()=>{const e=document.documentElement.getAttribute("data-theme")==="light"?"dark":"light";document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e),f.innerHTML=e==="light"?'<i class="fa-solid fa-moon"></i> Mode sombre':'<i class="fa-solid fa-sun"></i> Mode clair'});document.addEventListener("load",()=>{m.textContent=a.getParticipantsCount()});

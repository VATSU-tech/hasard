(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const p of s.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&i(p)}).observe(document,{childList:!0,subtree:!0});function n(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(t){if(t.ep)return;t.ep=!0;const s=n(t);fetch(t.href,s)}})();const d=document.getElementById("input"),o=document.getElementById("noms"),c=document.getElementById("result"),L=document.getElementById("btn-reset"),y=document.getElementById("btn-hasard"),E=document.getElementById("btn-ajouter"),v=document.getElementById("selectGroupe"),g=document.getElementById("checkGroupe"),m=document.getElementById("btn-undo");document.getElementById("btn-export");document.getElementById("btn-print");const a=document.getElementById("btn-afficher"),h="hasard_app_participants",u={save(r){try{localStorage.setItem(h,JSON.stringify(r))}catch(e){console.error("Storage save error:",e)}},load(){try{const r=localStorage.getItem(h);return r?JSON.parse(r):[]}catch(r){return console.error("Storage load error:",r),[]}},clear(){try{localStorage.removeItem(h)}catch(r){console.error("Storage clear error:",r)}}};function I(r){return Math.floor(Math.random()*r)}function B(r){const e=I(r.length);return{item:r[e],index:e}}class x{constructor(e){this.participants=[],this.nextId=1,this.deletedStack=[],this.participants=e&&e.length?e:u.load(),this.participants.length&&(this.nextId=Math.max(...this.participants.map(n=>n.id))+1),this.renderParticipantList(),this.updateButtons()}addParticipant(e){const n=e.trim();if(!n)return null;const i={id:this.nextId++,name:n};return this.participants.push(i),u.save(this.participants),this.appendParticipantNode(i),this.updateButtons(),i}deleteParticipant(e){const n=this.participants.findIndex(s=>s.id===e);if(n===-1)return;const[i]=this.participants.splice(n,1);this.deletedStack.push(i),u.save(this.participants),this.renderParticipantList(),this.updateButtons();const t=new CustomEvent("participantDeleted",{detail:i});document.dispatchEvent(t),a.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none"}undoDelete(){const e=this.deletedStack.pop();if(!e)return;this.participants.push(e),this.participants.sort((i,t)=>i.id-t.id),u.save(this.participants),this.renderParticipantList(),this.updateButtons();const n=new CustomEvent("participantUndo",{detail:e});document.dispatchEvent(n)}reset(){this.participants=[],this.deletedStack=[],this.nextId=1,u.clear(),this.clearDom(),this.updateButtons(),a.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none"}generateRandomOrder(){const e=[...this.participants],n=[];for(;e.length;){const{item:i,index:t}=B(e);n.push(i),e.splice(t,1)}return n}generateRandomGroups(e){const n=this.generateRandomOrder(),i=[];for(;n.length;)i.push(n.splice(0,e));return i}clearDom(){o.innerHTML="",c.innerHTML=""}renderParticipantList(){o.innerHTML="",this.participants.forEach(e=>this.appendParticipantNode(e))}appendParticipantNode(e){const n=document.createElement("div");n.className="participant-row";const i=document.createElement("span");i.textContent=`${e.id}. ${e.name}`;const t=document.createElement("button");t.innerHTML='<span class="material-symbols-outlined">delete</span>',t.title="Supprimer ce participant",t.className="delete-btn",t.addEventListener("click",()=>this.deleteParticipant(e.id)),n.appendChild(i),n.appendChild(t),o.appendChild(n)}renderOrder(e){c.innerHTML="",e.forEach((i,t)=>{const s=document.createElement("p");s.textContent=`${t+1}. ${i.name}`,c.appendChild(s)});const n=document.createElement("h3");n.textContent="Fin",n.style.color="var(--troisieme-color)",c.appendChild(n)}renderGroups(e){c.innerHTML="",e.forEach((i,t)=>{const s=document.createElement("h2");s.textContent=`Groupe ${t+1}`,c.appendChild(s),i.forEach((p,b)=>{const f=document.createElement("p");f.textContent=`${b+1}. ${p.name}`,c.appendChild(f)})});const n=document.createElement("h3");n.textContent="Fin",n.style.color="var(--troisieme-color)",c.appendChild(n)}count(){return this.participants.length}updateButtons(){y.disabled=this.participants.length===0}Afficher(e){a.addEventListener("click",()=>{a.classList.toggle("plusMoins")})}}const l=new x;function S(){d.style.boxShadow=""}E.addEventListener("click",()=>{if(!l.addParticipant(d.value)){d.style.boxShadow="0 0 20px red",d.focus();return}d.value="",S(),o.scrollTop=o.scrollHeight,a.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none"});d.addEventListener("input",()=>{d.classList.add("inputAnimation"),d.style.boxShadow=""});document.addEventListener("keydown",r=>{r.key==="Enter"&&E.click()});L.addEventListener("click",r=>{r.preventDefault(),l.reset(),m.disabled=!0});g.addEventListener("change",()=>{v.style.display=g.checked?"inline-block":"none"});y.addEventListener("click",()=>{if(g.checked){const r=parseInt(v.value,10)||1,e=l.generateRandomGroups(r);l.renderGroups(e)}else{const r=l.generateRandomOrder();l.renderOrder(r)}});m.addEventListener("click",()=>{l.undoDelete(),m.disabled=!0,a.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none"});document.addEventListener("participantDeleted",()=>{m.disabled=!1});a.addEventListener("click",()=>{o.classList.toggle("plusMoins"),a.textContent=o.classList.contains("plusMoins")?"Afficher plus":"Afficher moins"});a.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none";

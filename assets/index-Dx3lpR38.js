(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const p of s.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&r(p)}).observe(document,{childList:!0,subtree:!0});function n(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(t){if(t.ep)return;t.ep=!0;const s=n(t);fetch(t.href,s)}})();const d=document.getElementById("input"),o=document.getElementById("noms"),c=document.getElementById("result"),B=document.getElementById("btn-reset"),E=document.getElementById("btn-hasard"),v=document.getElementById("btn-ajouter"),g=document.getElementById("theme-toggle"),b=document.getElementById("selectGroupe"),f=document.getElementById("checkGroupe"),u=document.getElementById("btn-undo");document.getElementById("btn-export");document.getElementById("btn-print");const a=document.getElementById("btn-afficher"),h="hasard_app_participants",m={save(i){try{localStorage.setItem(h,JSON.stringify(i))}catch(e){console.error("Storage save error:",e)}},load(){try{const i=localStorage.getItem(h);return i?JSON.parse(i):[]}catch(i){return console.error("Storage load error:",i),[]}},clear(){try{localStorage.removeItem(h)}catch(i){console.error("Storage clear error:",i)}}};function k(i){return Math.floor(Math.random()*i)}function x(i){const e=k(i.length);return{item:i[e],index:e}}class S{constructor(e){this.participants=[],this.nextId=1,this.deletedStack=[],this.participants=e&&e.length?e:m.load(),this.participants.length&&(this.nextId=Math.max(...this.participants.map(n=>n.id))+1),this.renderParticipantList(),this.updateButtons()}addParticipant(e){const n=e.trim();if(!n)return null;const r={id:this.nextId++,name:n};return this.participants.push(r),m.save(this.participants),this.appendParticipantNode(r),this.updateButtons(),r}deleteParticipant(e){const n=this.participants.findIndex(s=>s.id===e);if(n===-1)return;const[r]=this.participants.splice(n,1);this.deletedStack.push(r),m.save(this.participants),this.renderParticipantList(),this.updateButtons();const t=new CustomEvent("participantDeleted",{detail:r});document.dispatchEvent(t),a.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none"}undoDelete(){const e=this.deletedStack.pop();if(!e)return;this.participants.push(e),this.participants.sort((r,t)=>r.id-t.id),m.save(this.participants),this.renderParticipantList(),this.updateButtons();const n=new CustomEvent("participantUndo",{detail:e});document.dispatchEvent(n)}reset(){this.participants=[],this.deletedStack=[],this.nextId=1,m.clear(),this.clearDom(),this.updateButtons(),a.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none"}generateRandomOrder(){const e=[...this.participants],n=[];for(;e.length;){const{item:r,index:t}=x(e);n.push(r),e.splice(t,1)}return n}generateRandomGroups(e){const n=this.generateRandomOrder(),r=[];for(;n.length;)r.push(n.splice(0,e));return r}clearDom(){o.innerHTML="",c.innerHTML=""}renderParticipantList(){o.innerHTML="",this.participants.forEach(e=>this.appendParticipantNode(e))}appendParticipantNode(e){const n=document.createElement("div");n.className="participant-row";const r=document.createElement("span");r.textContent=`${e.id}. ${e.name}`;const t=document.createElement("button");t.innerHTML='<span class="material-symbols-outlined">delete</span>',t.title="Supprimer ce participant",t.className="delete-btn",t.addEventListener("click",()=>this.deleteParticipant(e.id)),n.appendChild(r),n.appendChild(t),o.appendChild(n)}renderOrder(e){c.innerHTML="",e.forEach((r,t)=>{const s=document.createElement("p");s.textContent=`${t+1}. ${r.name}`,c.appendChild(s)});const n=document.createElement("h3");n.textContent="Fin",n.style.color="var(--troisieme-color)",c.appendChild(n)}renderGroups(e){c.innerHTML="",e.forEach((r,t)=>{const s=document.createElement("h2");s.textContent=`Groupe ${t+1}`,c.appendChild(s),r.forEach((p,I)=>{const y=document.createElement("p");y.textContent=`${I+1}. ${p.name}`,c.appendChild(y)})});const n=document.createElement("h3");n.textContent="Fin",n.style.color="var(--troisieme-color)",c.appendChild(n)}count(){return this.participants.length}updateButtons(){E.disabled=this.participants.length===0}Afficher(e){a.addEventListener("click",()=>{a.classList.toggle("plusMoins")})}}const l=new S;function M(){d.style.boxShadow=""}v.addEventListener("click",()=>{if(!l.addParticipant(d.value)){d.style.boxShadow="0 0 20px red",d.focus();return}d.value="",M(),o.scrollTop=o.scrollHeight,a.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none"});d.addEventListener("input",()=>{d.classList.add("inputAnimation"),d.style.boxShadow=""});document.addEventListener("keydown",i=>{i.key==="Enter"&&v.click()});B.addEventListener("click",i=>{i.preventDefault(),l.reset(),u.disabled=!0});f.addEventListener("change",()=>{b.style.display=f.checked?"inline-block":"none"});E.addEventListener("click",()=>{if(f.checked){const i=parseInt(b.value,10)||1,e=l.generateRandomGroups(i);l.renderGroups(e)}else{const i=l.generateRandomOrder();l.renderOrder(i)}});u.addEventListener("click",()=>{l.undoDelete(),u.disabled=!0,a.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none"});document.addEventListener("participantDeleted",()=>{u.disabled=!1});a.addEventListener("click",()=>{o.classList.toggle("plusMoins"),a.textContent=o.classList.contains("plusMoins")?"Afficher plus":"Afficher moins"});a.style.display=o.getElementsByTagName("div").length>3?"inline-block":"none";const C=localStorage.getItem("theme"),T=window.matchMedia("(prefers-color-scheme: dark)").matches,L=C||(T?"dark":"light");document.documentElement.setAttribute("data-theme",L);g.innerHTML=L==="light"?'<i class="fa-solid fa-moon"></i> Mode sombre':'<i class="fa-solid fa-sun"></i> Mode clair';g.addEventListener("click",()=>{const e=document.documentElement.getAttribute("data-theme")==="light"?"dark":"light";document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e),g.innerHTML=e==="light"?'<i class="fa-solid fa-moon"></i> Mode sombre':'<i class="fa-solid fa-sun"></i> Mode clair'});
